


label     : /[a-zA-Z0-9_]+|[~]/
argument  : ["["label(","label)*"]"]statement
statement : label["("argument[","argument]*")"]



labsgar     : "{"multistrat(","multistrat)*"}"
            | [label":"]statement
multistrat  : ["["multistrat(","multistrat)*"]"]labsgar
strategy    : ["["multistrat(","multistrat)*"]"][label":"]statement


scopemop : label -> label
         | "["scopemop (","scopemop)* "]"
introducer : "|"scopemop(","scopemop)*"|" -> scopemop


objargument      : introducer? object
objargumentnamed : [label"="]objargument
                 | "="label

?object : objectun ("->("object")")*

?objectun : objectinter ("|" objectinter)*

?objectinter : objectnot ("^" objectnot)*

?objectnot : "!" objectnot -> lognot
           | objectlogop

compsymbol: ">>" -> gtsym | "=>>" -> gteqsym | "==" -> eqsym | "!=" -> neqsym | "<<" -> ltsym | "<<=" -> lteqsym

?objectlogop : objectsum
             | objectsum (compsymbol objectsum)+    -> compchain
             | objectsum"=("object")="objectsum     -> customeq
             | objectsum"=!("object")="objectsum    -> customneq

!objectsum : "-"? objectprod [("+"|"-") objectprod]

?objectprod : objectatom ("*" objectatom)*

objargumentseries : objargument(","objargument)*
objargumentnamedseries : objargumentnamed(","objargumentnamed)*
objargumentstratseries : declaration (","declaration)*

objectatom : [objectatom"."]label["("objargumentseries")"]["<"objargumentnamedseries">"] -> treeref
           | "("objargumentnamedseries")"                                                -> union
           | "{"objargumentstratseries"}"                                                -> andtype




objstrategy : (label":"|introducer":")? ("["objargumentstratseries"]")? object

declaration : objstrategy["="object]








//?or_test: and_test ("or" and_test)*
//?and_test: not_test ("and" not_test)*
//?not_test: "not" not_test | comparison
//?comparison: expr (comp_op expr)*
//comp_op: "<"|">"|"=="|">="|"<="|"<>"|"!="
//?expr: xor_expr ("|" xor_expr)*
//?xor_expr: and_expr ("^" and_expr)*
//?and_expr: shift_expr ("&" shift_expr)*
//?shift_expr: arith_expr (("<<"|">>") arith_expr)*
//?arith_expr: term (("+"|"-") term)*
//?term: factor (("*"|"/"|"%"|"//") factor)*
//?factor: ("+"|"-"|"~") factor | power
//?power: molecule ["**" factor]


















start : objstrategy



%ignore /#[^\n]*/
%ignore " "
%ignore "\n"

